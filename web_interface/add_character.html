<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ·»åŠ è§’è‰² - æ¸¸æˆè§’è‰²ç®¡ç†ç³»ç»Ÿ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        .nav {
            background: #34495e;
            padding: 0;
        }
        .nav ul {
            list-style: none;
            display: flex;
            justify-content: center;
        }
        .nav li {
            margin: 0 5px;
        }
        .nav a {
            display: block;
            padding: 15px 25px;
            color: white;
            text-decoration: none;
            transition: background 0.3s;
        }
        .nav a:hover, .nav a.active {
            background: #2c3e50;
        }
        .content {
            padding: 40px;
        }
        .form-container {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            margin-top: 20px;
        }
        .form-section {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }
        .form-section h3 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.3em;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        .form-group {
            margin-bottom: 20px;
        }
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #2c3e50;
        }
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #3498db;
        }
        .form-group small {
            color: #666;
            font-size: 12px;
        }
        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }
        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background: #f8f9fa;
            transition: background 0.3s;
        }
        .checkbox-item:hover {
            background: #e9ecef;
        }
        .checkbox-item input[type="checkbox"] {
            width: auto;
        }
        .checkbox-item.checked {
            background: #d4edda;
            border-color: #28a745;
        }
        .trait-positive { border-left: 4px solid #28a745; }
        .trait-negative { border-left: 4px solid #dc3545; }
        .trait-neutral { border-left: 4px solid #6c757d; }
        .slider-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        .slider-item {
            text-align: center;
        }
        .slider-item input[type="range"] {
            width: 100%;
            margin: 10px 0;
        }
        .slider-value {
            font-weight: bold;
            color: #3498db;
            font-size: 1.2em;
        }
        .button {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            text-decoration: none;
            display: inline-block;
            margin: 10px 5px;
            transition: transform 0.3s, box-shadow 0.3s;
        }
        .button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
        }
        .button.success {
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
        }
        .button.secondary {
            background: linear-gradient(135deg, #95a5a6 0%, #7f8c8d 100%);
        }
        .button-group {
            text-align: center;
            margin-top: 30px;
        }
        .alert {
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 5px;
            display: none;
        }
        .alert.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .alert.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .random-btn {
            background: #e74c3c;
            color: white;
            padding: 5px 10px;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
            margin-left: 10px;
        }
        .availability-toggle {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
        }
        .toggle-switch {
            position: relative;
            width: 60px;
            height: 30px;
            background: #ccc;
            border-radius: 15px;
            cursor: pointer;
            transition: background 0.3s;
        }
        .toggle-switch.active {
            background: #2ecc71;
        }
        .toggle-switch::after {
            content: '';
            position: absolute;
            top: 3px;
            left: 3px;
            width: 24px;
            height: 24px;
            background: white;
            border-radius: 50%;
            transition: transform 0.3s;
        }
        .toggle-switch.active::after {
            transform: translateX(30px);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>â• æ·»åŠ æ–°è§’è‰²</h1>
            <p>åˆ›å»ºä¸€ä¸ªæ–°çš„æ¸¸æˆè§’è‰²</p>
        </div>
        
        <nav class="nav">
            <ul>
                <li><a href="index.html">ä¸»é¡µ</a></li>
                <li><a href="add_character.html" class="active">æ·»åŠ è§’è‰²</a></li>
                <li><a href="view_characters.php">æŸ¥çœ‹è§’è‰²</a></li>
            </ul>
        </nav>
        
        <div class="content">
            <div class="alert" id="alert"></div>
            
            <form id="characterForm" class="form-container" onsubmit="return submitCharacter(event)">
                <h2>è§’è‰²ä¿¡æ¯</h2>
                
                <div class="form-grid">
                    <!-- åŸºæœ¬ä¿¡æ¯ -->
                    <div class="form-section">
                        <h3>ğŸ­ åŸºæœ¬ä¿¡æ¯</h3>
                        <div class="form-group">
                            <label for="characterName">è§’è‰²åç§° *</label>
                            <input type="text" id="characterName" name="characterName" required>
                            <small>è§’è‰²çš„å®Œæ•´åç§°ï¼Œä¾‹å¦‚ï¼šé¾™è¡€æˆ˜å£«Â·é˜¿å…‹æ–¯</small>
                        </div>
                        <div class="form-group">
                            <label for="displayName">æ˜¾ç¤ºåç§°</label>
                            <input type="text" id="displayName" name="displayName">
                            <small>ç®€çŸ­çš„æ˜¾ç¤ºåç§°ï¼Œä¾‹å¦‚ï¼šé˜¿å…‹æ–¯</small>
                        </div>
                        <div class="form-group">
                            <label for="characterClass">èŒä¸š *</label>
                            <select id="characterClass" name="characterClass" required>
                                <option value="">é€‰æ‹©èŒä¸š</option>
                                <option value="warrior">æˆ˜å£« (Warrior)</option>
                                <option value="trader">å•†äºº (Trader)</option>
                                <option value="explorer">æ¢é™©å®¶ (Explorer)</option>
                                <option value="scholar">å­¦è€… (Scholar)</option>
                                <option value="mystic">æ³•å¸ˆ (Mystic)</option>
                                <option value="survivor">ç”Ÿå­˜è€… (Survivor)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="rarity">ç¨€æœ‰åº¦ *</label>
                            <select id="rarity" name="rarity" required onchange="updateCostsByRarity()">
                                <option value="">é€‰æ‹©ç¨€æœ‰åº¦</option>
                                <option value="common">æ™®é€š (Common)</option>
                                <option value="uncommon">ä¸å‡¡ (Uncommon)</option>
                                <option value="rare">ç¨€æœ‰ (Rare)</option>
                                <option value="epic">å²è¯— (Epic)</option>
                                <option value="legendary">ä¼ å¥‡ (Legendary)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="hireCost">é›‡ä½£è´¹ç”¨</label>
                            <input type="number" id="hireCost" name="hireCost" min="0" step="100" value="1000">
                            <small>é›‡ä½£è¯¥è§’è‰²æ‰€éœ€çš„è´¹ç”¨</small>
                        </div>
                        <div class="form-group">
                            <label for="maintenanceCost">ç»´æŠ¤è´¹ç”¨</label>
                            <input type="number" id="maintenanceCost" name="maintenanceCost" min="0" step="10" value="100">
                            <small>æ¯æ—¥ç»´æŠ¤è´¹ç”¨</small>
                        </div>
                        <div class="form-group">
                            <label>å¯ç”¨çŠ¶æ€</label>
                            <div class="availability-toggle">
                                <span>ä¸å¯ç”¨</span>
                                <div class="toggle-switch active" id="availabilityToggle" onclick="toggleAvailability()"></div>
                                <span>å¯ç”¨</span>
                                <input type="hidden" id="isAvailable" name="isAvailable" value="1">
                            </div>
                            <small>è®¾ç½®è§’è‰²æ˜¯å¦å¯è¢«é›‡ä½£</small>
                        </div>
                    </div>

                    <!-- åŸºç¡€å±æ€§ -->
                    <div class="form-section">
                        <h3>âš”ï¸ åŸºç¡€å±æ€§</h3>
                        <div class="slider-group">
                            <div class="slider-item">
                                <label>ğŸ’ª åŠ›é‡</label>
                                <input type="range" id="strength" name="strength" min="1" max="20" value="10" oninput="updateSliderValue(this)">
                                <div class="slider-value" id="strengthValue">10</div>
                            </div>
                            <div class="slider-item">
                                <label>â¤ï¸ ä½“åŠ›</label>
                                <input type="range" id="vitality" name="vitality" min="1" max="20" value="10" oninput="updateSliderValue(this)">
                                <div class="slider-value" id="vitalityValue">10</div>
                            </div>
                            <div class="slider-item">
                                <label>âš¡ æ•æ·</label>
                                <input type="range" id="agility" name="agility" min="1" max="20" value="10" oninput="updateSliderValue(this)">
                                <div class="slider-value" id="agilityValue">10</div>
                            </div>
                            <div class="slider-item">
                                <label>ğŸ§  æ™ºåŠ›</label>
                                <input type="range" id="intelligence" name="intelligence" min="1" max="20" value="10" oninput="updateSliderValue(this)">
                                <div class="slider-value" id="intelligenceValue">10</div>
                            </div>
                            <div class="slider-item">
                                <label>âœ¨ ä¿¡ä»°</label>
                                <input type="range" id="faith" name="faith" min="1" max="20" value="10" oninput="updateSliderValue(this)">
                                <div class="slider-value" id="faithValue">10</div>
                            </div>
                            <div class="slider-item">
                                <label>ğŸ€ å¹¸è¿</label>
                                <input type="range" id="luck" name="luck" min="1" max="20" value="10" oninput="updateSliderValue(this)">
                                <div class="slider-value" id="luckValue">10</div>
                            </div>
                        </div>
                        <div style="text-align: center; margin-top: 15px;">
                            <button type="button" class="random-btn" onclick="randomizeAttributes()">ğŸ² éšæœºç”Ÿæˆ</button>
                        </div>
                    </div>

                    <!-- ç²¾ç¥å±æ€§ -->
                    <div class="form-section">
                        <h3>ğŸ§˜ ç²¾ç¥å±æ€§</h3>
                        <div class="slider-group">
                            <div class="slider-item">
                                <label>ğŸ›¡ï¸ å¿ è¯š</label>
                                <input type="range" id="loyalty" name="loyalty" min="1" max="100" value="50" oninput="updateSliderValue(this)">
                                <div class="slider-value" id="loyaltyValue">50</div>
                            </div>
                            <div class="slider-item">
                                <label>âš”ï¸ å‹‡æ°”</label>
                                <input type="range" id="courage" name="courage" min="1" max="100" value="50" oninput="updateSliderValue(this)">
                                <div class="slider-value" id="courageValue">50</div>
                            </div>
                            <div class="slider-item">
                                <label>â³ è€å¿ƒ</label>
                                <input type="range" id="patience" name="patience" min="1" max="100" value="50" oninput="updateSliderValue(this)">
                                <div class="slider-value" id="patienceValue">50</div>
                            </div>
                            <div class="slider-item">
                                <label>ğŸ’° è´ªå©ª</label>
                                <input type="range" id="greed" name="greed" min="1" max="100" value="50" oninput="updateSliderValue(this)">
                                <div class="slider-value" id="greedValue">50</div>
                            </div>
                            <div class="slider-item">
                                <label>ğŸ“š æ™ºæ…§</label>
                                <input type="range" id="wisdom" name="wisdom" min="1" max="100" value="50" oninput="updateSliderValue(this)">
                                <div class="slider-value" id="wisdomValue">50</div>
                            </div>
                            <div class="slider-item">
                                <label>ğŸ­ é­…åŠ›</label>
                                <input type="range" id="charisma" name="charisma" min="1" max="100" value="50" oninput="updateSliderValue(this)">
                                <div class="slider-value" id="charismaValue">50</div>
                            </div>
                        </div>
                        <div style="text-align: center; margin-top: 15px;">
                            <button type="button" class="random-btn" onclick="randomizeMentalAttributes()">ğŸ² éšæœºç”Ÿæˆ</button>
                        </div>
                    </div>

                    <!-- ä¸“ä¸šæŠ€èƒ½ -->
                    <div class="form-section">
                        <h3>ğŸ¯ ä¸“ä¸šæŠ€èƒ½</h3>
                        <div class="slider-group">
                            <div class="slider-item">
                                <label>ğŸ“ˆ äº¤æ˜“æŠ€èƒ½</label>
                                <input type="range" id="tradeSkill" name="tradeSkill" min="1" max="100" value="10" oninput="updateSliderValue(this)">
                                <div class="slider-value" id="tradeSkillValue">10</div>
                            </div>
                            <div class="slider-item">
                                <label>ğŸ—¡ï¸ å†’é™©æŠ€èƒ½</label>
                                <input type="range" id="ventureSkill" name="ventureSkill" min="1" max="100" value="10" oninput="updateSliderValue(this)">
                                <div class="slider-value" id="ventureSkillValue">10</div>
                            </div>
                            <div class="slider-item">
                                <label>ğŸ¤ è°ˆåˆ¤æŠ€èƒ½</label>
                                <input type="range" id="negotiationSkill" name="negotiationSkill" min="1" max="100" value="10" oninput="updateSliderValue(this)">
                                <div class="slider-value" id="negotiationSkillValue">10</div>
                            </div>
                            <div class="slider-item">
                                <label>ğŸ” åˆ†ææŠ€èƒ½</label>
                                <input type="range" id="analysisSkill" name="analysisSkill" min="1" max="100" value="10" oninput="updateSliderValue(this)">
                                <div class="slider-value" id="analysisSkillValue">10</div>
                            </div>
                            <div class="slider-item">
                                <label>ğŸ‘‘ é¢†å¯¼æŠ€èƒ½</label>
                                <input type="range" id="leadershipSkill" name="leadershipSkill" min="1" max="100" value="10" oninput="updateSliderValue(this)">
                                <div class="slider-value" id="leadershipSkillValue">10</div>
                            </div>
                        </div>
                        <div style="text-align: center; margin-top: 15px;">
                            <button type="button" class="random-btn" onclick="randomizeSkills()">ğŸ² éšæœºç”Ÿæˆ</button>
                        </div>
                    </div>

                    <!-- æ€§æ ¼ç‰¹è´¨ -->
                    <div class="form-section">
                        <h3>ğŸŒŸ æ€§æ ¼ç‰¹è´¨</h3>
                        <p style="margin-bottom: 15px; color: #666;">é€‰æ‹©è§’è‰²çš„æ€§æ ¼ç‰¹è´¨ï¼ˆæœ€å¤šé€‰æ‹©5ä¸ªï¼‰</p>
                        <div class="checkbox-group" id="traitsGroup">
                            <!-- ç§¯æç‰¹è´¨ -->
                            <div class="checkbox-item trait-positive">
                                <input type="checkbox" id="trait_å‹¤å¥‹" name="traits" value="å‹¤å¥‹">
                                <label for="trait_å‹¤å¥‹">âœ¨ å‹¤å¥‹</label>
                            </div>
                            <div class="checkbox-item trait-positive">
                                <input type="checkbox" id="trait_å†·é™" name="traits" value="å†·é™">
                                <label for="trait_å†·é™">â„ï¸ å†·é™</label>
                            </div>
                            <div class="checkbox-item trait-positive">
                                <input type="checkbox" id="trait_å¹¸è¿" name="traits" value="å¹¸è¿">
                                <label for="trait_å¹¸è¿">ğŸ€ å¹¸è¿</label>
                            </div>
                            <div class="checkbox-item trait-positive">
                                <input type="checkbox" id="trait_ä¸“æ³¨" name="traits" value="ä¸“æ³¨">
                                <label for="trait_ä¸“æ³¨">ğŸ¯ ä¸“æ³¨</label>
                            </div>
                            <div class="checkbox-item trait-positive">
                                <input type="checkbox" id="trait_ä¹è§‚" name="traits" value="ä¹è§‚">
                                <label for="trait_ä¹è§‚">ğŸ˜Š ä¹è§‚</label>
                            </div>
                            <div class="checkbox-item trait-positive">
                                <input type="checkbox" id="trait_è°¨æ…" name="traits" value="è°¨æ…">
                                <label for="trait_è°¨æ…">ğŸ›¡ï¸ è°¨æ…</label>
                            </div>
                            <div class="checkbox-item trait-positive">
                                <input type="checkbox" id="trait_é¢†è¢–æ°”è´¨" name="traits" value="é¢†è¢–æ°”è´¨">
                                <label for="trait_é¢†è¢–æ°”è´¨">ğŸ‘‘ é¢†è¢–æ°”è´¨</label>
                            </div>
                            <div class="checkbox-item trait-positive">
                                <input type="checkbox" id="trait_ç›´è§‰æ•é”" name="traits" value="ç›´è§‰æ•é”">
                                <label for="trait_ç›´è§‰æ•é”">ğŸ‘ï¸ ç›´è§‰æ•é”</label>
                            </div>
                            <div class="checkbox-item trait-positive">
                                <input type="checkbox" id="trait_åšéŸ§" name="traits" value="åšéŸ§">
                                <label for="trait_åšéŸ§">ğŸ’ª åšéŸ§</label>
                            </div>
                            <div class="checkbox-item trait-positive">
                                <input type="checkbox" id="trait_å­¦ä¹ èƒ½åŠ›å¼º" name="traits" value="å­¦ä¹ èƒ½åŠ›å¼º">
                                <label for="trait_å­¦ä¹ èƒ½åŠ›å¼º">ğŸ“š å­¦ä¹ èƒ½åŠ›å¼º</label>
                            </div>
                            
                            <!-- æ¶ˆæç‰¹è´¨ -->
                            <div class="checkbox-item trait-negative">
                                <input type="checkbox" id="trait_å†²åŠ¨" name="traits" value="å†²åŠ¨">
                                <label for="trait_å†²åŠ¨">âš¡ å†²åŠ¨</label>
                            </div>
                            <div class="checkbox-item trait-negative">
                                <input type="checkbox" id="trait_è´ªå©ª" name="traits" value="è´ªå©ª">
                                <label for="trait_è´ªå©ª">ğŸ’° è´ªå©ª</label>
                            </div>
                            <div class="checkbox-item trait-negative">
                                <input type="checkbox" id="trait_æ‡’æƒ°" name="traits" value="æ‡’æƒ°">
                                <label for="trait_æ‡’æƒ°">ğŸ˜´ æ‡’æƒ°</label>
                            </div>
                            <div class="checkbox-item trait-negative">
                                <input type="checkbox" id="trait_ç„¦è™‘" name="traits" value="ç„¦è™‘">
                                <label for="trait_ç„¦è™‘">ğŸ˜° ç„¦è™‘</label>
                            </div>
                            <div class="checkbox-item trait-negative">
                                <input type="checkbox" id="trait_èƒŒå›è€…" name="traits" value="èƒŒå›è€…">
                                <label for="trait_èƒŒå›è€…">ğŸ—¡ï¸ èƒŒå›è€…</label>
                            </div>
                            
                            <!-- ä¸­æ€§ç‰¹è´¨ -->
                            <div class="checkbox-item trait-neutral">
                                <input type="checkbox" id="trait_å®Œç¾ä¸»ä¹‰" name="traits" value="å®Œç¾ä¸»ä¹‰">
                                <label for="trait_å®Œç¾ä¸»ä¹‰">â­ å®Œç¾ä¸»ä¹‰</label>
                            </div>
                            <div class="checkbox-item trait-neutral">
                                <input type="checkbox" id="trait_ç‹¬è¡Œä¾ " name="traits" value="ç‹¬è¡Œä¾ ">
                                <label for="trait_ç‹¬è¡Œä¾ ">ğŸº ç‹¬è¡Œä¾ </label>
                            </div>
                            <div class="checkbox-item trait-neutral">
                                <input type="checkbox" id="trait_ç¥ç§˜ä¸»ä¹‰" name="traits" value="ç¥ç§˜ä¸»ä¹‰">
                                <label for="trait_ç¥ç§˜ä¸»ä¹‰">ğŸ”® ç¥ç§˜ä¸»ä¹‰</label>
                            </div>
                        </div>
                        <div style="text-align: center; margin-top: 15px;">
                            <button type="button" class="random-btn" onclick="randomizeTraits()">ğŸ² éšæœºé€‰æ‹©</button>
                            <button type="button" class="random-btn" onclick="clearTraits()">ğŸ—‘ï¸ æ¸…ç©ºé€‰æ‹©</button>
                        </div>
                        <div id="traitCount" style="text-align: center; margin-top: 10px; color: #666;">
                            å·²é€‰æ‹©ï¼š0/5
                        </div>
                    </div>
                </div>

                <div class="button-group">
                    <button type="submit" class="button success">âœ¨ åˆ›å»ºè§’è‰²</button>
                    <button type="button" class="button secondary" onclick="resetForm()">ğŸ”„ é‡ç½®è¡¨å•</button>
                    <a href="view_characters.php" class="button">ğŸ‘¥ æŸ¥çœ‹è§’è‰²</a>
                </div>
            </form>
        </div>
    </div>

    <script>
        // æ›´æ–°æ»‘å—å€¼æ˜¾ç¤º
        function updateSliderValue(slider) {
            document.getElementById(slider.id + 'Value').textContent = slider.value;
        }

        // æ ¹æ®ç¨€æœ‰åº¦æ›´æ–°è´¹ç”¨
        function updateCostsByRarity() {
            const rarity = document.getElementById('rarity').value;
            const hireCostInput = document.getElementById('hireCost');
            const maintenanceCostInput = document.getElementById('maintenanceCost');
            
            const costs = {
                'common': { hire: 3000, maintenance: 150 },
                'uncommon': { hire: 8000, maintenance: 250 },
                'rare': { hire: 15000, maintenance: 400 },
                'epic': { hire: 25000, maintenance: 600 },
                'legendary': { hire: 50000, maintenance: 1000 }
            };
            
            if (costs[rarity]) {
                hireCostInput.value = costs[rarity].hire;
                maintenanceCostInput.value = costs[rarity].maintenance;
            }
        }

        // åˆ‡æ¢å¯ç”¨çŠ¶æ€
        function toggleAvailability() {
            const toggle = document.getElementById('availabilityToggle');
            const input = document.getElementById('isAvailable');
            
            if (toggle.classList.contains('active')) {
                toggle.classList.remove('active');
                input.value = '0';
            } else {
                toggle.classList.add('active');
                input.value = '1';
            }
        }

        // éšæœºç”ŸæˆåŸºç¡€å±æ€§
        function randomizeAttributes() {
            const attributes = ['strength', 'vitality', 'agility', 'intelligence', 'faith', 'luck'];
            attributes.forEach(attr => {
                const value = Math.floor(Math.random() * 15) + 6; // 6-20
                document.getElementById(attr).value = value;
                updateSliderValue(document.getElementById(attr));
            });
        }

        // éšæœºç”Ÿæˆç²¾ç¥å±æ€§
        function randomizeMentalAttributes() {
            const attributes = ['loyalty', 'courage', 'patience', 'greed', 'wisdom', 'charisma'];
            attributes.forEach(attr => {
                const value = Math.floor(Math.random() * 80) + 20; // 20-100
                document.getElementById(attr).value = value;
                updateSliderValue(document.getElementById(attr));
            });
        }

        // éšæœºç”ŸæˆæŠ€èƒ½
        function randomizeSkills() {
            const skills = ['tradeSkill', 'ventureSkill', 'negotiationSkill', 'analysisSkill', 'leadershipSkill'];
            skills.forEach(skill => {
                const value = Math.floor(Math.random() * 70) + 10; // 10-80
                document.getElementById(skill).value = value;
                updateSliderValue(document.getElementById(skill));
            });
        }

        // éšæœºé€‰æ‹©ç‰¹è´¨
        function randomizeTraits() {
            clearTraits();
            const checkboxes = document.querySelectorAll('input[name="traits"]');
            const numTraits = Math.floor(Math.random() * 4) + 2; // 2-5ä¸ªç‰¹è´¨
            const indices = [];
            
            while (indices.length < numTraits) {
                const randomIndex = Math.floor(Math.random() * checkboxes.length);
                if (!indices.includes(randomIndex)) {
                    indices.push(randomIndex);
                }
            }
            
            indices.forEach(index => {
                checkboxes[index].checked = true;
                updateCheckboxStyle(checkboxes[index]);
            });
            
            updateTraitCount();
        }

        // æ¸…ç©ºç‰¹è´¨é€‰æ‹©
        function clearTraits() {
            const checkboxes = document.querySelectorAll('input[name="traits"]');
            checkboxes.forEach(checkbox => {
                checkbox.checked = false;
                updateCheckboxStyle(checkbox);
            });
            updateTraitCount();
        }

        // æ›´æ–°å¤é€‰æ¡†æ ·å¼
        function updateCheckboxStyle(checkbox) {
            const item = checkbox.closest('.checkbox-item');
            if (checkbox.checked) {
                item.classList.add('checked');
            } else {
                item.classList.remove('checked');
            }
        }

        // æ›´æ–°ç‰¹è´¨è®¡æ•°
        function updateTraitCount() {
            const checkedTraits = document.querySelectorAll('input[name="traits"]:checked');
            document.getElementById('traitCount').textContent = `å·²é€‰æ‹©ï¼š${checkedTraits.length}/5`;
            
            // é™åˆ¶æœ€å¤š5ä¸ªç‰¹è´¨
            const allTraits = document.querySelectorAll('input[name="traits"]');
            allTraits.forEach(trait => {
                if (!trait.checked && checkedTraits.length >= 5) {
                    trait.disabled = true;
                    trait.closest('.checkbox-item').style.opacity = '0.5';
                } else {
                    trait.disabled = false;
                    trait.closest('.checkbox-item').style.opacity = '1';
                }
            });
        }

        // é‡ç½®è¡¨å•
        function resetForm() {
            if (confirm('ç¡®å®šè¦é‡ç½®è¡¨å•å—ï¼Ÿæ‰€æœ‰è¾“å…¥çš„æ•°æ®å°†ä¸¢å¤±ã€‚')) {
                document.getElementById('characterForm').reset();
                
                // é‡ç½®æ»‘å—æ˜¾ç¤ºå€¼
                const sliders = document.querySelectorAll('input[type="range"]');
                sliders.forEach(slider => {
                    updateSliderValue(slider);
                });
                
                // é‡ç½®ç‰¹è´¨é€‰æ‹©
                clearTraits();
                
                // é‡ç½®å¯ç”¨çŠ¶æ€
                document.getElementById('availabilityToggle').classList.add('active');
                document.getElementById('isAvailable').value = '1';
            }
        }

        // æäº¤è¡¨å•
        function submitCharacter(event) {
            event.preventDefault();
            
            const formData = new FormData(document.getElementById('characterForm'));
            
            // æ”¶é›†é€‰ä¸­çš„ç‰¹è´¨
            const checkedTraits = Array.from(document.querySelectorAll('input[name="traits"]:checked'))
                .map(checkbox => checkbox.value);
            formData.set('traits', JSON.stringify(checkedTraits));
            
            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            const submitBtn = document.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            submitBtn.textContent = 'â³ åˆ›å»ºä¸­...';
            submitBtn.disabled = true;
            
            fetch('api/add_character.php', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                showAlert(data.success ? 'success' : 'error', data.message);
                if (data.success) {
                    setTimeout(() => {
                        window.location.href = 'view_characters.php';
                    }, 2000);
                }
            })
            .catch(error => {
                showAlert('error', 'ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•');
                console.error('Error:', error);
            })
            .finally(() => {
                submitBtn.textContent = originalText;
                submitBtn.disabled = false;
            });
            
            return false;
        }

        // æ˜¾ç¤ºæç¤ºä¿¡æ¯
        function showAlert(type, message) {
            const alert = document.getElementById('alert');
            alert.className = `alert ${type}`;
            alert.textContent = message;
            alert.style.display = 'block';
            
            setTimeout(() => {
                alert.style.display = 'none';
            }, 5000);
        }

        // é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            // ä¸ºç‰¹è´¨å¤é€‰æ¡†æ·»åŠ äº‹ä»¶ç›‘å¬
            const traitCheckboxes = document.querySelectorAll('input[name="traits"]');
            traitCheckboxes.forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    updateCheckboxStyle(this);
                    updateTraitCount();
                });
            });
            
            // åˆå§‹åŒ–ç‰¹è´¨è®¡æ•°
            updateTraitCount();
        });
    </script>
</body>
</html> 